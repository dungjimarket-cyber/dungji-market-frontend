# 🏪 둥지마켓 회원 상태별 버튼 구성표 v3.0

## 📌 중요: v3.0 변경사항
- **bidding 상태 제거**: 모집과 입찰이 동시 진행 (recruiting 상태에서 모두 처리)
- 상태 흐름: recruiting → final_selection_buyers → final_selection_seller → in_progress → completed/cancelled

## 🔓 비로그인 회원 버튼 구성

| 페이지 | 버튼 구성 | 비고 |
|--------|----------|------|
| 목록 페이지 | `공구 둘러보기` | 클릭 시 로그인 페이지로 이동 |
| 상세 페이지 | `공구 참여하기`<br>`공동구매 공유하기` | • 공구 참여하기: 로그인 페이지로 이동<br>• 공동구매 공유하기: 카카오톡 공유 |

## 👤 일반회원(구매회원) 상태별 버튼 구성

### 공구 진행 중 (recruiting 상태)

| 상태 | 설명 | 목록 페이지 | 상세 페이지 |
|------|------|------------|------------|
| 🔍 공구 참여 전 | 로그인 후 미참여 | `공구 참여하기` | `공구 참여하기`<br>`공동구매 공유하기` |
| ✅ 공구 참여 후 | 공구 참여 완료 | `참여 완료` | `공구 나가기`*<br>`공동구매 공유하기`<br><small>*입찰 진행시 나가기 제한</small> |

### 공구 종료 후 진행 단계 (6개 카테고리)

| 카테고리 | 상태 | 설명 | 목록 버튼 | 상세 페이지 기능 |
|----------|------|------|-----------|-----------------|
| 📁 참여중인 공구 | recruiting | 모집/입찰 진행중 | `공구보기` | `공구 나가기`* |
| ⏰ 구매확정/포기 선택하기 | final_selection_buyers | 12시간 타이머 | `구매확정/포기 선택` | `구매확정/포기 선택하기`<br>🎉 최종 낙찰 알림 |
| ⏳ 판매자 최종선택 대기중 | final_selection_seller | 6시간 타이머 | `판매자최종선택중` | 구매확정 상태 표시<br>실시간 타이머 |
| 💼 거래중 | in_progress | 실제 거래 진행 | `거래중` | `판매자 정보 확인하기`<br>`노쇼신고하기`<br>`구매완료` |
| ✅ 구매완료 | completed | 최종거래 완료 | `구매완료` | `구매후기 작성` |
| ❌ 취소된 공구 | cancelled | 포기/만료 | `공구취소` | 취소 사유 표시 |

## 🏪 판매회원 상태별 버튼 구성

### 입찰 진행 (recruiting 상태에서 처리)

| 상태 | 설명 | 목록 페이지 | 상세 페이지 |
|------|------|------------|------------|
| 💰 입찰 전 | 미입찰 상태 | `공구 입찰하기` | 💵 금액 입력창<br>`입찰하기` |
| ✅ 입찰 후 | 입찰 완료 | `다시 입찰하기` | 💵 금액 입력창<br>`다시 입찰하기` |

### 낙찰 후 진행 단계 (6개 카테고리)

| 카테고리 | 상태 | 설명 | 목록 버튼 | 상세 페이지 기능 |
|----------|------|------|-----------|-----------------|
| 📋 입찰내역 | recruiting | 입찰 참여 목록 | `다시 입찰하기` | `입찰 순위 확인`<br>`입찰 취소하기` |
| ⏳ 구매자 최종선택 대기중 | final_selection_buyers | 12시간 타이머 | `진행상황` | `참여인원 확인`<br>🎉 최종 낙찰 알림 |
| ⏰ 판매확정/포기 선택하기 | final_selection_seller | 6시간 타이머 | `판매확정/포기 선택하기` | `구매확정 인원 보기`<br>`판매확정`<br>`판매포기` |
| 💼 거래중 | in_progress | 실제 거래 진행 | `거래중` | `구매자 정보 확인하기`<br>`노쇼신고하기`<br>`판매완료` |
| ✅ 판매완료 | completed | 최종거래 완료 | `판매완료` | `구매자 정보 확인하기` |
| ❌ 취소된 공구 | cancelled | 포기/전원포기 | `공구취소` | 취소 사유 표시 |

## 💰 입찰금액 표시 규칙

### 금액 공개 시점
1. **모집/입찰 진행중 (recruiting)**
   - 본인 입찰금액: 정상 표기
   - 타인 입찰금액: 앞자리 외 마스킹(*)

2. **모집종료 후 (final_selection_buyers 이후)**
   - 공구 참여자: 모든 입찰금액 정상 표기
   - 미참여자: 앞자리 외 마스킹(*)
   - 낙찰 판매자: 최종 낙찰 금액 정상 표기

### 낙찰 알림
- "🎉 축하합니다! 최종 낙찰되셨습니다."
- "최종 낙찰 지원금: ***,***원"

## ⚠️ 주요 규칙

### 50% 규칙 (판매자 보호)
- 구매확정률 ≤ 50%: 판매포기시 패널티 없음 + 입찰권 환불

### 타임아웃 처리
- 구매자: 12시간 미선택시 → 자동 구매포기
- 판매자: 6시간 미선택시 → 자동 판매포기 (패널티)

### 재선택 기능
- 구매자: 12시간 내 모든 참여자 선택 완료 전까지 재선택 가능

### 입찰 제한
- 입찰 단위: 1,000원
- 최대 금액: 999만원

## 🔔 주요 알림 시점
1. 구매자 선택 시작: "12시간 내 구매확정/포기 선택하세요"
2. 구매자 선택 1시간 전: "⚠️ 선택 시간 1시간 남음"
3. 판매자 선택 시작: "6시간 내 판매확정/포기 선택하세요"
4. 거래 성사: "거래가 성사되었습니다"
5. 연락처 공개: "📞 상대방 연락처가 공개되었습니다"

## 📝 구현 체크리스트

### ✅ 구현 완료
- [x] recruiting 상태에서 입찰 가능 (v3.0)
- [x] 구매확정/포기 선택 버튼
- [x] 판매확정/포기 선택 버튼
- [x] 거래중 상태 버튼
- [x] 완료 상태 버튼
- [x] 금액 마스킹 규칙

### ⚠️ 확인 필요
- [ ] bidding 상태 완전 제거 확인
- [ ] 모든 버튼 텍스트 정확성
- [ ] 상태별 버튼 표시 조건
- [ ] 타이머 표시
- [ ] 알림 발송 시점