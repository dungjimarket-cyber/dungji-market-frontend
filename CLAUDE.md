# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview
Dungji Market (ë‘¥ì§€ë§ˆì¼“) is a Next.js-based group purchasing platform for telecommunications and internet services in Korea. Users can create and participate in group purchases to get better deals on mobile plans, internet services, and electronics.

**PWA Ready**: The application is now configured as a Progressive Web App (PWA) and ready for deployment to iOS App Store and Google Play Store.

## âš ï¸ CRITICAL: ì½”ë“œ ë¶„ë¦¬ ê·œì¹™

### ğŸš« ì ˆëŒ€ ìˆ˜ì • ê¸ˆì§€ ê·œì¹™
**ì¤‘ê³ ê±°ë˜ ê¸°ëŠ¥ ì‘ì—… ì‹œ ê³µêµ¬(Group Purchase) ê´€ë ¨ ì½”ë“œëŠ” ì ˆëŒ€ ìˆ˜ì •í•˜ì§€ ë§ˆì„¸ìš”!**

1. **ê³µêµ¬ ì „ìš© íŒŒì¼ë“¤ (ìˆ˜ì • ê¸ˆì§€)**:
   - `src/app/mypage/MyPageClient.tsx` - ê³µêµ¬ ë§ˆì´í˜ì´ì§€
   - `src/components/group-purchase/*` - ê³µêµ¬ ê´€ë ¨ ì»´í¬ë„ŒíŠ¸
   - `src/app/group-purchases/*` - ê³µêµ¬ í˜ì´ì§€ë“¤
   - `src/app/seller-dashboard/*` - íŒë§¤ì ëŒ€ì‹œë³´ë“œ
   - ê¸°íƒ€ ê³µêµ¬ ê´€ë ¨ ëª¨ë“  íŒŒì¼

2. **ì¤‘ê³ ê±°ë˜ ì „ìš© íŒŒì¼ë“¤**:
   - `src/components/used/*` - ì¤‘ê³ ê±°ë˜ ì»´í¬ë„ŒíŠ¸
   - `src/app/used/*` - ì¤‘ê³ ê±°ë˜ í˜ì´ì§€ë“¤
   - `src/components/mypage/profile/ProfileSection.tsx` - ì¤‘ê³ ê±°ë˜ í”„ë¡œí•„
   - `src/components/mypage/sales/*` - íŒë§¤ ë‚´ì—­
   - `src/components/mypage/purchases/*` - êµ¬ë§¤ ë‚´ì—­
   - `src/components/mypage/favorites/*` - ì°œ ëª©ë¡

3. **ì‘ì—… ì›ì¹™**:
   - âŒ ê³µêµ¬ ì½”ë“œ ìˆ˜ì • ì‹œë„ ì‹œ â†’ **ì¦‰ì‹œ ì¤‘ë‹¨í•˜ê³  ì‚¬ìš©ìì—ê²Œ í™•ì¸ ìš”ì²­**
   - âœ… ì¤‘ê³ ê±°ë˜ ì½”ë“œë§Œ ìˆ˜ì •
   - âš ï¸ ê³µí†µ íŒŒì¼ ìˆ˜ì • í•„ìš” ì‹œ â†’ **ë°˜ë“œì‹œ ì‚¬ìš©ìì—ê²Œ ë¨¼ì € í™•ì¸**

4. **ê³µí†µ íŒŒì¼ ìˆ˜ì • ì‹œ ì£¼ì˜**:
   - `src/contexts/AuthContext.tsx` - ì–‘ìª½ì—ì„œ ì‚¬ìš©, ìˆ˜ì • ì‹œ ì˜í–¥ í™•ì¸ í•„ìˆ˜
   - `src/lib/api/*` - API ì„œë¹„ìŠ¤ íŒŒì¼ë“¤
   - íƒ€ì… ì •ì˜ íŒŒì¼ë“¤

**ìœ„ë°˜ ì‹œ**: ê³µêµ¬ ê¸°ëŠ¥ì´ ê¹¨ì ¸ì„œ í° ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!

## Development Commands

### Core Commands
```bash
npm run dev           # Start development server (http://localhost:3000)
npm run build         # Build for production
npm run start         # Start production server
npm run lint          # Run ESLint
npm run test          # Run Jest tests
npm run test:watch    # Run tests in watch mode
npm run test:coverage # Run tests with coverage report
```

### Testing Commands
```bash
npm test -- src/__tests__/issue-verification.test.tsx  # Run specific test file
npm test -- --updateSnapshot                           # Update test snapshots
npm test -- --watchAll                                 # Run all tests in watch mode
npm test -- --coverage                                 # Generate coverage report
npm test -- src/components/                            # Test all files in directory
```

## Architecture Overview

### Tech Stack
- **Framework**: Next.js 15.1.6 with App Router
- **UI**: React 19, Tailwind CSS, Radix UI components
- **State Management**: Zustand for global state, React Hook Form for forms
- **Authentication**: NextAuth.js with JWT tokens, supports Kakao/Google OAuth
- **Backend Integration**: Axios for API calls, WebSocket for real-time features
- **API Base URL**: `${process.env.NEXT_PUBLIC_API_URL}` = `https://api.dungjimarket.com/api`
- **Testing**: Jest with React Testing Library
- **Deployment**: Vercel with serverless functions
- **PWA**: next-pwa with Service Worker and offline caching

### Key Directories
- `src/app/` - Next.js App Router pages and API routes
  - `src/app/api/` - Backend API routes (auth, groupbuys, payment, etc.)
  - `src/app/(partner)/` - Partner-specific routes with shared layout
- `src/components/` - Reusable React components organized by feature
  - `src/components/ui/` - Base UI components (shadcn/ui components)
  - `src/components/auth/` - Authentication-related components
  - `src/components/groupbuy/` - Group buying functionality components
- `src/contexts/` - React Context providers (AuthContext, PartnerContext)
- `src/lib/` - Utility functions and service layers
  - `src/lib/api/` - API service functions organized by feature
- `src/stores/` - Zustand stores for state management
- `src/types/` - TypeScript type definitions
- `src/hooks/` - Custom React hooks
- `src/middleware/` - Next.js middleware for authentication
- `public/` - Static assets including PWA icons and manifest

### PWA Configuration
- **Manifest**: `/public/manifest.json` - App metadata and icons
- **Service Worker**: Auto-generated by next-pwa
- **Icons**: Multiple sizes (72x72 to 512x512) in `/public/icons/`
- **Caching Strategy**: Network-first with 30-day expiration
- **Install Prompt**: Available on supported devices

### Authentication Flow
The app uses a dual authentication system:
1. **NextAuth.js** for OAuth providers (Kakao, Google)
2. **Custom JWT** implementation for email/password authentication
3. Auth tokens are stored in localStorage and managed via AuthContext
4. Role-based access control for buyers (ì¼ë°˜íšŒì›) and sellers (íŒë§¤ì)

### API Integration Pattern
- **Base API URL**: `${process.env.NEXT_PUBLIC_API_URL}` = `https://api.dungjimarket.com/api`
- **API URL Pattern**: `${NEXT_PUBLIC_API_URL}/auth/endpoint` â†’ `https://api.dungjimarket.com/api/auth/endpoint`
- **â—ï¸ CRITICAL**: NEXT_PUBLIC_API_URL already includes `/api`, so NEVER add `/api` again!
- Auth headers automatically attached via axios interceptors
- Token refresh handled automatically on 401 responses
- API services organized in `src/lib/api/` by feature

#### âœ… Correct API URL Examples
- Profile: `${NEXT_PUBLIC_API_URL}/auth/profile/`
- Nickname Check: `${NEXT_PUBLIC_API_URL}/auth/check-nickname/`
- Nickname Change Status: `${NEXT_PUBLIC_API_URL}/auth/nickname-change-status/`
- Regions: `${NEXT_PUBLIC_API_URL}/regions/`

#### âŒ WRONG Examples (Never Use These!)
- `${NEXT_PUBLIC_API_URL}/api/auth/endpoint` â† WRONG! Duplicate `/api`
- `https://api.dungjimarket.com/auth/endpoint` â† WRONG! Hardcoded URL

#### ğŸ“‹ Before Adding New API Calls:
1. Check existing API calls in the same file for pattern
2. Use `${NEXT_PUBLIC_API_URL}/path` format
3. Never add `/api` prefix to the path

### Key Features & Routes

#### User Types
- **ì¼ë°˜íšŒì› (Buyers)**: Can create/join group purchases
- **íŒë§¤ì (Sellers)**: Can bid on group purchases, requires business verification

#### Main Pages
- `/` - Homepage with active group purchases
- `/group-purchases/create` - Create new group purchase
- `/groupbuys/[id]` - Group purchase detail page
- `/mypage` - User dashboard (different views for buyers/sellers)
- `/seller-dashboard` - Seller management interface
- `/bid-tickets` - Bid token purchase page

### Component Patterns
- Use existing UI components from `src/components/ui/`
- Follow shadcn/ui patterns for new components
- Client components marked with `'use client'` directive
- Server components by default in App Router

### Form Handling
- Use React Hook Form with Zod validation
- Form schemas defined alongside components
- Validation errors displayed via form.formState.errors

### Real-time Features
- Bid updates via WebSocket connections
- Timer synchronization for auction deadlines
- Notification system for bid status changes

## Environment Variables Required
```
NEXT_PUBLIC_API_URL              # Backend API URL
NEXT_PUBLIC_APP_URL              # Frontend URL
NEXTAUTH_URL                     # NextAuth base URL
NEXTAUTH_SECRET                  # NextAuth encryption secret
JWT_SECRET                       # JWT signing secret
KAKAO_CLIENT_ID                  # Kakao OAuth credentials
KAKAO_CLIENT_SECRET
GOOGLE_CLIENT_ID                 # Google OAuth credentials
GOOGLE_CLIENT_SECRET
```

## Common Development Tasks

### Adding a New Page
1. Create route in `src/app/[route]/page.tsx`
2. Add navigation link in DesktopNavbar/MobileNavbar if needed
3. Implement authentication check if required

### Creating API Routes
1. Add route handler in `src/app/api/[route]/route.ts`
2. Use NextResponse for responses
3. Handle auth verification via JWT tokens

### Working with Group Purchases
- Main types defined in `src/types/groupbuy.ts`
- State management via `src/stores/useGroupPurchase.ts`
- API services in `src/lib/api/`

### Styling Guidelines
- Use Tailwind CSS utility classes
- Follow existing component patterns
- Responsive design with mobile-first approach
- Dark mode not currently implemented

### PWA Development
- PWA disabled in development mode (next-pwa config)
- Test PWA features in production build: `npm run build && npm run start`
- Service worker updates on app reload
- Offline functionality for cached resources

## Development Workflow

**IMPORTANT: After implementing any feature or fix, ALWAYS follow this workflow:**

1. **Build the project** to check for compilation errors:
   ```bash
   npm run build
   ```

2. **Test the changes** locally if applicable:
   ```bash
   npm run dev
   # Test the feature in the browser
   ```

3. **Commit and push** the changes:
   ```bash
   git add -A
   git commit -m "type: description of changes
   
   - Detail 1
   - Detail 2
   
   ğŸ¤– Generated with [Claude Code](https://claude.ai/code)
   
   Co-Authored-By: Claude <noreply@anthropic.com>"
   git push origin main
   ```

**This workflow ensures:**
- Code compiles without errors before deployment
- Changes are tested locally
- All changes are properly versioned and deployed
- Vercel automatically deploys on push to main

## Testing Approach
- **Test Framework**: Jest with React Testing Library
- **Test Location**: Test files in `src/__tests__/` or alongside components
- **Path Aliases**: `@/` maps to `src/` directory
- **Coverage**: Excludes `*.d.ts`, `layout.tsx`, and `globals.css`
- **Transforms**: Configured to handle `lucide-react` imports
- Unit tests for utilities and hooks
- Integration tests for critical user flows
- Mock API responses for testing

## Deployment Notes
- Deployed on Vercel with automatic deployments on push to main branch
- Serverless functions for API routes with 60s timeout
- Cron jobs configured for status updates (`/api/cron/`)
- Image optimization disabled due to Vercel free tier limits
- Node.js version: >=18.0.0 (check `.nvmrc` for specific version)
- PWA files (service worker, manifest) auto-generated during build

## PWA Deployment
- **Ready for App Stores**: See `PWA_DEPLOYMENT_GUIDE.md` for complete deployment instructions
- **Recommended Tools**: PWABuilder.com for packaging iOS/Android apps
- **App Store Requirements**: All assets and metadata configured
- **Testing**: Use Chrome DevTools > Application > Manifest to test PWA features

## Linting and Code Quality
- **ESLint**: Uses flat config format with TypeScript parser
- **Unused Imports**: Plugin configured but disabled for flexibility
- **Next.js Rules**: Enforced for proper HTML link usage
- Lint command: `npm run lint`

## ì¤‘ê³ í° ì§ê±°ë˜ ê¸°ëŠ¥ (Used Phone Trading)

### ê°œë°œ ë¬¸ì„œ
- **PRD**: `PRD_ì¤‘ê³ í°ì§ê±°ë˜.md` - ì œí’ˆ ìš”êµ¬ì‚¬í•­ ë° ë¹„ì¦ˆë‹ˆìŠ¤ ëª©í‘œ
- **ê¸°ëŠ¥ ëª…ì„¸ì„œ**: `ê¸°ëŠ¥ê°œë°œëª…ì„¸ì„œ_ì¤‘ê³ í°ì§ê±°ë˜.md` - ìƒì„¸ ê¸°ìˆ  êµ¬í˜„ ì‚¬ì–‘
- **ì‘ì—… ê´€ë¦¬**: `ì‘ì—…ê´€ë¦¬ë¬¸ì„œ_ì¤‘ê³ í°ì§ê±°ë˜.md` - ì§„í–‰ ìƒí™© ë° ì´ìŠˆ íŠ¸ë˜í‚¹

### ì£¼ìš” ê¸°ëŠ¥
- **ìƒí’ˆ ê´€ë¦¬**: ìµœëŒ€ 5ê°œ ë™ì‹œ ë“±ë¡, ë‹¤ì¤‘ ì´ë¯¸ì§€ ì—…ë¡œë“œ
- **ê±°ë˜ ì‹œìŠ¤í…œ**: ê°€ê²© ì œì•ˆ, ì¦‰ì‹œêµ¬ë§¤, ê±°ë˜ ìƒíƒœ ê´€ë¦¬
- **í”„ë¡œí•„ ì²´í¬**: ì¤‘ê³ í° ê±°ë˜ìš© í•„ìˆ˜ ì •ë³´ í™•ì¸ (ì—°ë½ì²˜, í™œë™ì§€ì—­)
- **ê²€ìƒ‰/í•„í„°**: ë¸Œëœë“œ, ê°€ê²©, ìš©ëŸ‰, ìƒíƒœë³„ í•„í„°ë§

### í•µì‹¬ ì»´í¬ë„ŒíŠ¸
```
src/components/used/
â”œâ”€â”€ UsedPhoneCard.tsx         # ìƒí’ˆ ì¹´ë“œ
â”œâ”€â”€ UsedPhoneFilter.tsx        # í•„í„° UI  
â”œâ”€â”€ UsedPhoneGallery.tsx       # ì´ë¯¸ì§€ ê°¤ëŸ¬ë¦¬
â”œâ”€â”€ PriceOfferModal.tsx        # ê°€ê²© ì œì•ˆ ëª¨ë‹¬
â”œâ”€â”€ RegistrationLimitModal.tsx # ë“±ë¡ ì œí•œ ì•ˆë‚´
â””â”€â”€ UsedPhoneForm.tsx          # ë“±ë¡/ìˆ˜ì • í¼
```

### API ì—”ë“œí¬ì¸íŠ¸
- `GET/POST /api/used/phones/` - ìƒí’ˆ ëª©ë¡/ë“±ë¡
- `GET/PUT/DELETE /api/used/phones/{id}/` - ìƒí’ˆ ìƒì„¸/ìˆ˜ì •/ì‚­ì œ
- `POST /api/used/phones/{id}/offer/` - ê°€ê²© ì œì•ˆ
- `GET /api/used/phones/{id}/my-offer/` - ë‚´ ì œì•ˆ ì¡°íšŒ
- `POST /api/used/phones/{id}/favorite/` - ì°œí•˜ê¸°
- `GET /api/used/phones/check-limit/` - ë“±ë¡ ì œí•œ ì²´í¬

### Custom Hooks
- `useUsedPhoneProfileCheck()` - ì¤‘ê³ í° ê±°ë˜ í”„ë¡œí•„ ì²´í¬
- `useImageUpload()` - ë‹¤ì¤‘ ì´ë¯¸ì§€ ì—…ë¡œë“œ ì²˜ë¦¬
- `usePriceOffer()` - ê°€ê²© ì œì•ˆ ê´€ë¦¬

### ê°œë°œ í˜„í™©
- **ì§„í–‰ë¥ **: 75% (Phase 1 ì™„ë£Œ, Phase 2 ì§„í–‰ì¤‘)
- **ì™„ë£Œ**: ê¸°ë³¸ CRUD, ì´ë¯¸ì§€ ì—…ë¡œë“œ, ê°€ê²© ì œì•ˆ, ì°œí•˜ê¸°
- **ì§„í–‰ì¤‘**: ë©”ì‹œì§€ ì‹œìŠ¤í…œ, ê±°ë˜ ì™„ë£Œ í”„ë¡œì„¸ìŠ¤
- **ì˜ˆì •**: í‰ê°€ ì‹œìŠ¤í…œ, ê²€ìƒ‰ ê³ ë„í™”, ì•Œë¦¼ ê¸°ëŠ¥

## ğŸ’³ ê²°ì œ ì‹œìŠ¤í…œ (ì´ë‹ˆì‹œìŠ¤)

### ê²°ì œ ë°©ì‹ë³„ ì²˜ë¦¬ í˜„í™©

#### âœ… ìë™ ì²˜ë¦¬ (ì™„ì „ ìë™í™”)
- **ì¹´ë“œ ê²°ì œ**: ì¦‰ì‹œ ì™„ë£Œ â†’ ê²¬ì ì´ìš©ê¶Œ ìë™ ì§€ê¸‰
- **ì‹¤ì‹œê°„ ê³„ì¢Œì´ì²´**: ì¦‰ì‹œ ì™„ë£Œ â†’ ê²¬ì ì´ìš©ê¶Œ ìë™ ì§€ê¸‰

#### âš ï¸ ìˆ˜ë™ ì²˜ë¦¬ í•„ìš” (ë¬´í†µì¥ì…ê¸ˆ)
**í˜„ì¬ ìƒí™©:**
1. ê³ ê°ì´ ë¬´í†µì¥ì…ê¸ˆ ì„ íƒ â†’ ê°€ìƒê³„ì¢Œ ë°œê¸‰ (`waiting_deposit` ìƒíƒœ)
2. ê³ ê°ì´ ì€í–‰ì— ì…ê¸ˆ
3. **ê´€ë¦¬ìê°€ ìˆ˜ë™ìœ¼ë¡œ ì²˜ë¦¬í•´ì•¼ í•¨:**
   - Django Admin â†’ ê²°ì œ ëª©ë¡ â†’ ì…ê¸ˆ ëŒ€ê¸° í•„í„°
   - í•´ë‹¹ ê²°ì œ ì„ íƒ â†’ "ì„ íƒëœ ê²°ì œë¥¼ ì™„ë£Œ ì²˜ë¦¬" ì•¡ì…˜ ì‹¤í–‰
   - âš ï¸ **ë¬¸ì œ: í˜„ì¬ ê²¬ì ì´ìš©ê¶Œì´ ìë™ ì§€ê¸‰ë˜ì§€ ì•ŠìŒ**

**í•„ìš”í•œ ê°œì„ ì‚¬í•­:**
1. **ë‹¨ê¸° í•´ê²°**: Django Adminì˜ `mark_as_completed` ì•¡ì…˜ì— ê²¬ì ì´ìš©ê¶Œ ì§€ê¸‰ ë¡œì§ ì¶”ê°€
2. **ì¥ê¸° í•´ê²°**: ì›¹í›… URL ì—°ê²° (`/api/payments/inicis/webhook/`)í•˜ì—¬ ì™„ì „ ìë™í™”
   - `api/urls.py`ì— ì›¹í›… ë¼ìš°íŒ… ì¶”ê°€ í•„ìš”
   - ì´ë‹ˆì‹œìŠ¤ ê´€ë¦¬ì í˜ì´ì§€ì—ì„œ ì›¹í›… URL ì„¤ì • í•„ìš”

### ê²°ì œ ì˜¤ë¥˜ ì²˜ë¦¬
- ê²°ì œ ì‹¤íŒ¨ ì‹œ ìƒì„¸ ì˜¤ë¥˜ ë©”ì‹œì§€ í‘œì‹œ (ì¹´ë“œ í•œë„, ì”ì•¡ ë¶€ì¡± ë“±)
- `INICIS_ERROR_MESSAGES`ì— í•œêµ­ì–´ ì˜¤ë¥˜ ë©”ì‹œì§€ ë§¤í•‘ ì™„ë£Œ

## Git ì»¤ë°‹/í‘¸ì‹œ ë°©ë²•

### Frontend ë³€ê²½ì‚¬í•­ ì»¤ë°‹/í‘¸ì‹œ
```bash
# 1. frontend ë””ë ‰í† ë¦¬ë¡œ ì´ë™
cd dungji-market-frontend

# 2. ë³€ê²½ì‚¬í•­ ìŠ¤í…Œì´ì§• ë° ì»¤ë°‹
git add -A
git commit -m "ì»¤ë°‹ ë©”ì‹œì§€"

# 3. main ë¸Œëœì¹˜ë¡œ í‘¸ì‹œ
git push origin main

# 4. ìƒìœ„ ë””ë ‰í† ë¦¬ë¡œ ëŒì•„ê°€ì„œ submodule ì—…ë°ì´íŠ¸
cd ..
git add dungji-market-frontend
git commit -m "update: sync frontend submodule for [ë³€ê²½ë‚´ìš©]"
```

**ì£¼ì˜**: ë©”ì¸ ì €ì¥ì†ŒëŠ” í˜„ì¬ remote ì„¤ì • ë¬¸ì œë¡œ í‘¸ì‹œê°€ ì•ˆë˜ë¯€ë¡œ, frontend ì„œë¸Œëª¨ë“ˆë§Œ í‘¸ì‹œí•˜ë©´ ë¨.

# important-instruction-reminders
Do what has been asked; nothing more, nothing less.
NEVER create files unless they're absolutely necessary for achieving your goal.
ALWAYS prefer editing an existing file to creating a new one.
NEVER proactively create documentation files (*.md) or README files. Only create documentation files if explicitly requested by the User.

## ğŸ¨ UI/UX ë””ìì¸ ì›ì¹™

### í…ìŠ¤íŠ¸ ë° ë ˆì´ì•„ì›ƒ
- **ì¤„ë°”ê¿ˆ ë°©ì§€**: Badge, Button ë“±ì˜ ì»´í¬ë„ŒíŠ¸ì—ì„œ `whitespace-nowrap` ì‚¬ìš©ìœ¼ë¡œ í…ìŠ¤íŠ¸ ì¤„ë°”ê¿ˆ ë°©ì§€
- **ì»´íŒ©íŠ¸í•œ ë””ìì¸**:
  - ì‘ì€ ë²„íŠ¼: `size="sm"` + `text-xs` + `px-3 py-1.5`
  - ì‘ì€ ì•„ì´ì½˜: `w-3 h-3` ì‚¬ìš©
  - í…ìŠ¤íŠ¸ ìµœì†Œí™”: "ë…¸ì‡¼ì‹ ê³ í•˜ê¸°" â†’ "ì‹ ê³ í•˜ê¸°"

### ìƒ‰ìƒ êµ¬ì„±
- **ê³¼í•˜ì§€ ì•Šì€ ìƒ‰ìƒ ì‚¬ìš©**:
  - ê²½ê³ /ìœ„í—˜: `text-red-600 border-red-300 hover:bg-red-50` (ë¹¨ê°„ìƒ‰ í…Œë‘ë¦¬ + ì—°í•œ í˜¸ë²„)
  - ëŒ€ê¸°/ê²€í† ì¤‘: `bg-gray-100 text-gray-700` (ì—°í•œ íšŒìƒ‰ ë°°ê²½)
  - ì„±ê³µ/ìŠ¹ì¸: ê¸°ë³¸ Badge variant ì‚¬ìš©
  - ì‹¤íŒ¨/ë°˜ë ¤: destructive variant ì‚¬ìš©

### ë²„íŠ¼ ìŠ¤íƒ€ì¼ ê°€ì´ë“œ
```tsx
// ì‘ì€ ì•„ì›ƒë¼ì¸ ë²„íŠ¼ (ê¶Œì¥)
<Button
  variant="outline"
  size="sm"
  className="flex items-center gap-1 text-red-600 border-red-300 hover:bg-red-50 text-xs px-3 py-1.5"
>
  <Icon className="w-3 h-3" />
  í…ìŠ¤íŠ¸
</Button>

// Badge ì¤„ë°”ê¿ˆ ë°©ì§€
<Badge className="bg-gray-100 text-gray-700 inline-flex whitespace-nowrap">
  <Icon className="w-3 h-3 mr-1 flex-shrink-0" />
  <span>í…ìŠ¤íŠ¸</span>
</Badge>
```

## ğŸš¨ í•„ë“œ ì ‘ê·¼ ì˜¤ë¥˜ ë°©ì§€ ì›ì¹™
**ë¬¸ì œ**: ë°±ì—”ë“œì—ì„œ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” í•„ë“œ ì ‘ê·¼ ì‹œ AttributeErrorë¡œ 500 ì˜¤ë¥˜ ë°œìƒ (5ì‹œê°„ ë””ë²„ê¹…)

**í•´ê²° ë°©ë²•**:
1. **í•„ë“œ ì¶”ê°€ ì „ DB ëª¨ë¸ í™•ì¸ í•„ìˆ˜**
   - `api/models.py`ì—ì„œ User, GroupBuy ë“± ëª¨ë¸ì˜ ì‹¤ì œ í•„ë“œ í™•ì¸
   - í”„ë¡ íŠ¸ì—”ë“œì— ìˆëŠ” í•„ë“œê°€ ë°±ì—”ë“œì—ë„ ìˆë‹¤ê³  ê°€ì •í•˜ì§€ ë§ ê²ƒ

2. **í”„ë¡ íŠ¸ì—”ë“œì™€ ë°±ì—”ë“œ í•„ë“œëª… ì°¨ì´ ì£¼ì˜**
   - í”„ë¡ íŠ¸: `user?.user_type` (optional chainingìœ¼ë¡œ ì•ˆì „)
   - ë°±ì—”ë“œ: `user.user_type` (ì§ì ‘ ì ‘ê·¼ ì‹œ í•„ë“œ ì—†ìœ¼ë©´ ì—ëŸ¬)

3. **ë””ë²„ê¹… ì‹œ ì¦‰ì‹œ í™•ì¸**
   - 500 ì˜¤ë¥˜ ë°œìƒ ì‹œ ìƒì„¸ ì˜¤ë¥˜ ë©”ì‹œì§€ ë°˜í™˜í•˜ë„ë¡ ìˆ˜ì •
   - `AttributeError: 'Model' object has no attribute 'field'` í˜•íƒœ ì˜¤ë¥˜ëŠ” DB ëª¨ë¸ í™•ì¸

**ì˜ˆì‹œ - User ëª¨ë¸ í•„ë“œ**:
- âœ… ì¡´ì¬: `role` (buyer/seller)
- âŒ ì—†ìŒ: `user_type`

**êµí›ˆ**: "í˜¹ì‹œ ëª¨ë¥´ë‹ˆê¹Œ" ë°©ì–´ ì½”ë“œê°€ ì˜¤íˆë ¤ ë¬¸ì œ ì¼ìœ¼í‚¬ ìˆ˜ ìˆìŒ. ì‹¤ì œ DB ìŠ¤í‚¤ë§ˆ í™•ì¸ì´ ìµœìš°ì„ !

## í•µì‹¬ ì‘ì—… ì›ì¹™ (ì‹œê°„ì´ ëˆì´ë‹¤)
1. **ì„ì‹œë°©í¸ ê¸ˆì§€** - ê·¼ë³¸ì ì¸ í•´ê²°ì±…ë§Œ ì œì‹œ
2. **ë°˜ë³µ ì‹¤ìˆ˜ ë°©ì§€**:
   - API URLì— /api ì¤‘ë³µ ì¶”ê°€ âŒ (NEXT_PUBLIC_API_URLì— ì´ë¯¸ í¬í•¨)
   - DB ë¬¸ì œë¥¼ ìˆ˜ë™ ëª…ë ¹ì–´ë¡œ í•´ê²° âŒ â†’ ì½”ë“œë¡œ ìë™ í•´ê²° âœ…
   - ë¬¸ì œ ì›ì¸ íŒŒì•… ì „ í•´ê²°ì±… ì œì‹œ âŒ â†’ ì›ì¸ ë¶„ì„ í›„ í•œ ë²ˆì— í•´ê²° âœ…
3. **íŒ¨í„´ ì¸ì‹**:
   - 404 ì˜¤ë¥˜ â†’ URL ê²½ë¡œ ë˜ëŠ” ViewSet ìœ„ì¹˜ ë¬¸ì œ
   - ìƒíƒœ ë¶ˆì¼ì¹˜ â†’ ëª¨ë¸ ë¡œì§ ë˜ëŠ” ìƒíƒœ ì „í™˜ ë¬¸ì œ
   - ì¹´ìš´íŠ¸ ì˜¤ë¥˜ â†’ Serializerì—ì„œ ì‹¤ì‹œê°„ ê³„ì‚°ìœ¼ë¡œ í•´ê²°
4. **ì²« ë²ˆì§¸ í•´ê²°ì±… = ìµœì¢… í•´ê²°ì±…** (ì—¬ëŸ¬ ë²ˆ ìˆ˜ì • ê¸ˆì§€)
5. **ê¸°ì¡´ ì½”ë“œ ìˆ˜ì • ì›ì¹™**:
   - ìƒˆ ê¸°ëŠ¥ ì¶”ê°€ ì‹œ ê¸°ì¡´ ì‘ë™ ì½”ë“œëŠ” ì ˆëŒ€ ìˆ˜ì • ê¸ˆì§€
   - íŠ¹íˆ Serializer í•„ë“œëª…ì€ ëª¨ë¸ê³¼ ì •í™•íˆ ì¼ì¹˜í•´ì•¼ í•¨
   - í•„ë“œ ì¶”ê°€ë§Œ í•˜ê³ , ê¸°ì¡´ í•„ë“œëŠ” ê±´ë“œë¦¬ì§€ ì•Šê¸°
   - ìˆ˜ì • ì „ í•­ìƒ ì›ë³¸ ìƒíƒœ í™•ì¸ í•„ìˆ˜
   - ListSerializerì™€ DetailSerializer í•„ë“œëª… ì¼ê´€ì„± ìœ ì§€

## ğŸ—ï¸ í†µí•© ëª¨ë¸ ë§ˆì´ê·¸ë ˆì´ì…˜ (2025.09)

### í†µí•© ì°œ/í›„ê¸° ì‹œìŠ¤í…œ
**ëª©ì **: íœ´ëŒ€í°ê³¼ ì „ìì œí’ˆì˜ ì°œ/í›„ê¸°ë¥¼ í•˜ë‚˜ì˜ í…Œì´ë¸”ë¡œ í†µí•© ê´€ë¦¬

#### UnifiedFavorite (í†µí•© ì°œ)
```python
# api/models_unified_simple.py
class UnifiedFavorite:
    user = ForeignKey(User)
    item_type = CharField(choices=['phone', 'electronics'])
    item_id = PositiveIntegerField()
    created_at = DateTimeField(auto_now_add=True)

    class Meta:
        unique_together = ('user', 'item_type', 'item_id')
```

#### UnifiedReview (í†µí•© í›„ê¸°)
```python
class UnifiedReview:
    item_type = CharField(choices=['phone', 'electronics'])
    transaction_id = PositiveIntegerField()  # ê±°ë˜ ID
    reviewer = ForeignKey(User, related_name='written_reviews')
    reviewee = ForeignKey(User, related_name='received_reviews')
    rating = IntegerField(1-5)
    comment = TextField()
    is_from_buyer = BooleanField()  # êµ¬ë§¤ì/íŒë§¤ì êµ¬ë¶„
    # ì¶”ê°€ í‰ê°€ í•­ëª©
    is_punctual = BooleanField()
    is_friendly = BooleanField()
    is_honest = BooleanField()
    is_fast_response = BooleanField()
```

#### Migration ì£¼ì˜ì‚¬í•­
1. **unique_together ë³€ê²½ ì‹œ**: ë¨¼ì € ê¸°ì¡´ ì œì•½ì¡°ê±´ ì œê±° â†’ í•„ë“œ ìˆ˜ì • â†’ ìƒˆ ì œì•½ì¡°ê±´ ì„¤ì •
2. **í•„ë“œëª… ë³€ê²½**: RenameField ì‚¬ìš© (ì˜ˆ: reviewed_user â†’ reviewee)
3. **í•„ë“œ íƒ€ì… ë³€ê²½**: RemoveField â†’ AddField ìˆœì„œë¡œ ì§„í–‰
4. **AlterUniqueTogether íŒŒë¼ë¯¸í„°**: `name=` ì‚¬ìš© (`model_name=` ì•„ë‹˜)

#### ì œê±°ëœ ëª¨ë¸ë“¤
- âŒ `UsedPhoneFavorite` â†’ âœ… `UnifiedFavorite`
- âŒ `ElectronicsFavorite` â†’ âœ… `UnifiedFavorite`
- âŒ `UsedPhoneReview` â†’ âœ… `UnifiedReview`

#### API ì—”ë“œí¬ì¸íŠ¸ ë³€ê²½
**ì°œí•˜ê¸°**:
- ì´ì „: POSTë§Œìœ¼ë¡œ í† ê¸€
- í˜„ì¬: POST (ì¶”ê°€) / DELETE (ì œê±°) ëª…í™•íˆ êµ¬ë¶„
```javascript
// Frontend
const method = isFavorited ? 'delete' : 'post';
await api[method](`/${id}/favorite/`);
```

**í›„ê¸°**:
- BackendëŠ” UnifiedReview ì‚¬ìš©í•˜ì§€ë§Œ ê¸°ì¡´ API ì—”ë“œí¬ì¸íŠ¸ ìœ ì§€
- Serializerì—ì„œ backward compatibility ì œê³µ (transaction â†’ transaction_id ë§¤í•‘)

### ì „ìì œí’ˆ ìƒíƒœ ë“±ê¸‰ ê°œì„ 
```javascript
// ê¸°ì¡´: Sê¸‰/Aê¸‰/Bê¸‰/Cê¸‰
// ê°œì„ ì•ˆ (íƒ€ í”Œë«í¼ ì°¸ì¡°):
CONDITION_CHOICES = [
    ('new_unopened', 'ë¯¸ê°œë´‰'),
    ('like_new', 'ê±°ì˜ ìƒˆ ê²ƒ'),
    ('minor_signs', 'ì‚¬ìš©ê° ì ìŒ'),
    ('visible_signs', 'ì‚¬ìš©ê° ìˆìŒ'),
    ('heavy_signs', 'ì‚¬ìš©ê° ë§ìŒ')
]
```

### prefetch_related ì •ë¦¬
```python
# ì‚­ì œëœ ê´€ê³„ëŠ” prefetchì—ì„œ ì œê±° í•„ìˆ˜
queryset = UsedPhone.objects.prefetch_related(
    'regions__region',
    'images',
    # 'favorites',  # âŒ ì œê±°ë¨
    'transactions'
)

      
      IMPORTANT: this context may or may not be relevant to your tasks. You should not respond to this context unless it is highly relevant to your task.